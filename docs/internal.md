<!-- Code generated by gomarkdoc. DO NOT EDIT -->

# config

```go
import "github.com/aaronlmathis/dynago/internal/config"
```

Package config provides configuration loading for dynago from YAML files.

The configuration supports multiple DNS providers, logging options, and update intervals.

## Index

- [type CloudflareConfig](<#CloudflareConfig>)
- [type Config](<#Config>)
  - [func LoadConfig\(path string\) \(\*Config, error\)](<#LoadConfig>)
- [type ProvidersConfig](<#ProvidersConfig>)
- [type Route53Config](<#Route53Config>)


<a name="CloudflareConfig"></a>
## type CloudflareConfig

CloudflareConfig holds Cloudflare\-specific configuration.

Fields:

- Enabled: Whether Cloudflare updates are enabled.
- APIToken: Cloudflare API token.
- ZoneID: Cloudflare zone ID.
- RecordName: DNS record name to update.
- RecordType: DNS record type \(A or AAAA\).
- Proxied: Whether the record should be proxied \(orange cloud in Cloudflare UI\).

```go
type CloudflareConfig struct {
    Enabled    bool   `yaml:"enabled"`
    APIToken   string `yaml:"api_token"`
    ZoneID     string `yaml:"zone_id"`
    RecordName string `yaml:"record_name"`
    RecordType string `yaml:"record_type"`
    Proxied    bool   `yaml:"proxied"`
}
```

<a name="Config"></a>
## type Config

Config represents the root configuration for dynago loaded from YAML.

Fields:

- Interval: How often to check for IP changes \(parsed as time.Duration\).
- IPSource: URL to determine the public IP address.
- LogLevel: Logging level \(debug, info, warn, error\).
- Providers: DNS provider configurations.

```go
type Config struct {
    Interval  time.Duration   `yaml:"interval"`
    IPSource  string          `yaml:"ip_source"`
    LogLevel  string          `yaml:"log_level"`
    Providers ProvidersConfig `yaml:"providers"`
}
```

<a name="LoadConfig"></a>
### func LoadConfig

```go
func LoadConfig(path string) (*Config, error)
```

LoadConfig loads the configuration from the given YAML file path.

It parses the YAML file, converts the interval string to time.Duration, and returns a Config struct or an error if parsing fails.

Example usage:

```
cfg, err := config.LoadConfig("configs/dynago.yml")
if err != nil {
    log.Fatal(err)
}
```

<a name="ProvidersConfig"></a>
## type ProvidersConfig

ProvidersConfig holds configuration for all supported DNS providers.

Fields:

- Cloudflare: Cloudflare provider configuration.
- Route53: AWS Route53 provider configuration.

```go
type ProvidersConfig struct {
    Cloudflare CloudflareConfig `yaml:"cloudflare"`
    Route53    Route53Config    `yaml:"route53"`
}
```

<a name="Route53Config"></a>
## type Route53Config

Route53Config holds AWS Route53\-specific configuration.

Fields:

- Enabled: Whether Route53 updates are enabled.
- AccessKeyID: AWS access key ID.
- SecretAccessKey: AWS secret access key.
- HostedZoneID: AWS hosted zone ID.
- RecordName: DNS record name to update.
- RecordType: DNS record type \(A or AAAA\).
- Region: AWS region.

```go
type Route53Config struct {
    Enabled         bool   `yaml:"enabled"`
    AccessKeyID     string `yaml:"access_key_id"`
    SecretAccessKey string `yaml:"secret_access_key"`
    HostedZoneID    string `yaml:"hosted_zone_id"`
    RecordName      string `yaml:"record_name"`
    RecordType      string `yaml:"record_type"`
    Region          string `yaml:"region"`
}
```

# logger

```go
import "github.com/aaronlmathis/dynago/internal/logger"
```

Package logger provides a simple logging system for the dynago application.

It supports different log levels \(debug, info, warn, error\), writes logs to a file and pretty\-prints to the console.

## Index

- [func Debug\(format string, args ...any\)](<#Debug>)
- [func Error\(format string, args ...any\)](<#Error>)
- [func Info\(format string, args ...any\)](<#Info>)
- [func InitLogger\(appLogFile, level string\) error](<#InitLogger>)
- [func Warn\(format string, args ...any\)](<#Warn>)


<a name="Debug"></a>
## func Debug

```go
func Debug(format string, args ...any)
```

Debug logs a debug message if the log level allows it.

```
format: Format string (like fmt.Printf).
args:   Arguments for the format string.
```

<a name="Error"></a>
## func Error

```go
func Error(format string, args ...any)
```

Error logs an error message if the log level allows it.

```
format: Format string (like fmt.Printf).
args:   Arguments for the format string.
```

<a name="Info"></a>
## func Info

```go
func Info(format string, args ...any)
```

Info logs an informational message if the log level allows it.

```
format: Format string (like fmt.Printf).
args:   Arguments for the format string.
```

<a name="InitLogger"></a>
## func InitLogger

```go
func InitLogger(appLogFile, level string) error
```

InitLogger initializes the logging system for the application.

All log messages are written to both the specified file and the console \(with pretty formatting\).

Parameters:

- appLogFile: Path to the application log file. If empty, logs are discarded.
- level: Logging level \("debug", "info", "warn", "error"\).

Returns an error if the log file cannot be opened.

Example:

```
err := logger.InitLogger("app.log", "", "debug")
if err != nil {
    panic(err)
}
```

<a name="Warn"></a>
## func Warn

```go
func Warn(format string, args ...any)
```

Warn logs a warning message if the log level allows it.

```
format: Format string (like fmt.Printf).
args:   Arguments for the format string.
```

# provider

The provider system has been refactored and is now public and extensible. Provider interfaces, registry, and implementations are no longer in `internal/provider` but in the top-level `providers/` directory.

- See [docs/providers.md](providers.md) for full documentation on the provider system, interface, and how to add new providers.
- Each provider (e.g., Cloudflare, Route53) is implemented in its own package under `providers/`.
- The provider registry and interface are now public in `providers/provider.go`.
- Provider configuration is now loaded as a `map[string]any` and passed to each provider's `New` function for parsing.

Legacy types and functions in `internal/provider` have been removed or replaced. Please refer to the new provider documentation for up-to-date API and usage.

# service

```go
import "github.com/aaronlmathis/dynago/internal/service"
```

Package service provides the DNS update service for dynago.

The DNSUpdateService periodically checks the current public IP address and updates DNS records via enabled providers \(Cloudflare, Route53, etc.\) if the IP has changed.

## Index

- [type DNSUpdateService](<#DNSUpdateService>)
  - [func NewDNSUpdateService\(ctx context.Context, cfg \*config.Config\) \*DNSUpdateService](<#NewDNSUpdateService>)
  - [func \(s \*DNSUpdateService\) Start\(\) error](<#DNSUpdateService.Start>)
  - [func \(s \*DNSUpdateService\) Stop\(\) error](<#DNSUpdateService.Stop>)


<a name="DNSUpdateService"></a>
## type DNSUpdateService

DNSUpdateService manages the periodic update of DNS records for the host's current public IP.

It loads configuration, initializes providers, and runs a loop to check and update DNS records as needed.

```go
type DNSUpdateService struct {
    // contains filtered or unexported fields
}
```

<a name="NewDNSUpdateService"></a>
### func NewDNSUpdateService

```go
func NewDNSUpdateService(ctx context.Context, cfg *config.Config) *DNSUpdateService
```

NewDNSUpdateService creates a new DNSUpdateService with the given context and configuration.

ctx: Context for cancellation and shutdown. cfg: Loaded application configuration.

<a name="DNSUpdateService.Start"></a>
### func \(\*DNSUpdateService\) Start

```go
func (s *DNSUpdateService) Start() error
```

Start begins the DNS update loop.

It periodically fetches the current public IP address using the configured source, compares it to the DNS records for each enabled provider, and updates the records if the IP has changed.

Returns an error if the service cannot start or if no providers are enabled.

<a name="DNSUpdateService.Stop"></a>
### func \(\*DNSUpdateService\) Stop

```go
func (s *DNSUpdateService) Stop() error
```

Stop stops the DNS update service and performs any necessary cleanup.

Returns an error if cleanup fails \(currently always returns nil\).

# utils

```go
import "github.com/aaronlmathis/dynago/internal/utils"
```

Package utils provides utility functions for dynago, such as public IP detection.

These helpers are used by the service layer to determine the current public IP address of the host.

## Index

- [func GetCurrentIP\(ipSource string\) \(string, error\)](<#GetCurrentIP>)


<a name="GetCurrentIP"></a>
## func GetCurrentIP

```go
func GetCurrentIP(ipSource string) (string, error)
```

GetCurrentIP fetches the current public IP address from the specified source URL.

ipSource: The URL of an external service that returns the public IP as plain text \(e.g., https://api.ipify.org\).

Returns the IP address as a string, or an error if the request fails or the response is not HTTP 200.

Example:

```
ip, err := utils.GetCurrentIP("https://api.ipify.org")
if err != nil {
    log.Fatal(err)
}
fmt.Println("Current IP:", ip)
```

Generated by [gomarkdoc](<https://github.com/princjef/gomarkdoc>)
